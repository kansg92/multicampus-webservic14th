<meta charset="UTF-8">
<style>
	#map{
		width:500px;
		height:400px;
		border: 2px solid tomato;
	}
</style>


<script>

var map = null;

function displayMarker(pos){
	$(pos).each(function(index,item){
		var marker = new kakao.maps.Marker({
			map:map,
			position: new kakao.maps.LatLng(item.lat, item.lng)
		});
		
		var infowindow = new kakao.maps.InfoWindow({
			content: item.content
		});
		
		kakao.maps.event.addListener(marker, 'mouseover', function() {
		 	 // 마커에 마우스오버 이벤트가 발생하면 인포윈도우를 마커위에 표시합니다
		    infowindow.open(map, marker);
		});
		kakao.maps.event.addListener(marker, 'mouseout', function() {
		    // 마커에 마우스아웃 이벤트가 발생하면 인포윈도우를 제거합니다
		    infowindow.close();
		});
		kakao.maps.event.addListener(marker, 'click', function() {
		    location.href=item.target;
		});
	});
	
};

function getmarkers(loc){
	$.ajax({
		url:'getmarkers',
		data:{loc:loc},
		success:function(data){
			console.log(data);
			displayMarker(data);
		}
	
	});

};

function gomap(loc){

	var latlng = null;

	if(loc == 's'){
		latlng = new kakao.maps.LatLng(37.55041692365908, 126.91037178013711);
		getmarkers('s');
	}else if(loc == 'b'){
		latlng = new kakao.maps.LatLng(35.17642453774257, 129.16669784099807);
		getmarkers('b');
	}else if(loc == 'g'){
		latlng = new kakao.maps.LatLng(35.16173425533525, 126.88758871719189);
		getmarkers('g');
	}
	map.panTo(latlng);
};

function displayMap(){
	var mapContainer = document.getElementById('map'); // 지도를 표시할 div 
	var mapOption = { 
    	center: new kakao.maps.LatLng(37.5032838,127.0498344), // 지도의 중심좌표
    	level: 5 // 지도의 확대 레벨
	};
	map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다	
	
};




$(document).ready(function(){
	displayMap();
	$('#s').click(function(){
		gomap('s')
	});

	$('#b').click(function(){
		gomap('b')
	});

	$('#g').click(function(){
		gomap('g')
	});

	
});

//서울 37.55041692365908, 126.91037178013711
//부산 35.17642453774257, 129.16669784099807
//광주 35.16173425533525, 126.88758871719189

</script>

<h1>AJAX11 Main</h1>
<button id="s">Seoul</button>

<button id="b">Busan</button>

<button id="g">Gwangju</button>

<div id="map"></div>
